<!doctype html>
<html lang="en">
	<head>
		<!-- Init theme as fast as possible -->
		<script theme-loader>
			try {
				const isDarkPreferred = window.matchMedia('(prefers-color-scheme: dark)').matches;

				const currentTheme =
					localStorage.nnsTheme === null ||
					localStorage.nnsTheme === undefined ||
					localStorage.nnsTheme === ''
						? undefined
						: JSON.parse(localStorage.nnsTheme);

				document.documentElement.setAttribute(
					'theme',
					currentTheme ?? (isDarkPreferred ? 'dark' : 'light')
				);
			} catch (error) {
				console.error('Error initializing theme', error);
			}
		</script>

		<!-- Init language as fast as possible -->
		<script language-loader>
			try {
				const currentLanguage =
					localStorage.lang === null || localStorage.lang === undefined || localStorage.lang === ''
						? undefined
						: JSON.parse(localStorage.lang);

				document.documentElement.setAttribute('lang', currentLanguage ?? 'en');
			} catch (error) {
				console.error('Error initializing language', error);
			}
		</script>

		<style>
			:root {
				&,
				#app-background-container {
					background: #e8f1ff;
				}
				color: #000;
			}
			:root[theme='dark'] {
				&,
				#app-background-container {
					background: #070f1c;
				}
				color: #f4f6fa;
			}
		</style>

		<!-- CONTENT_SECURITY_POLICY -->

		<meta charset="utf-8" />
		<meta content="width=device-width, initial-scale=1, viewport-fit=cover" name="viewport" />

		<title>{{OISY_NAME}}</title>
		<link href="https://oisy.com" rel="canonical" />
		<meta content="{{OISY_DESCRIPTION}}" name="description" />
		<meta content="{{OISY_NAME}}" property="og:title" />
		<meta content="{{OISY_DESCRIPTION}}" property="og:description" />
		<meta content="website" property="og:type" />
		<meta content="https://oisy.com" property="og:url" />
		<meta content="https://oisy.com/images/meta-share-v3.jpg" property="og:image" />
		<meta content="summary_large_image" name="twitter:card" />
		<meta content="{{OISY_NAME}}" name="twitter:title" />
		<meta content="{{OISY_DESCRIPTION}}" name="twitter:description" />
		<meta content="https://oisy.com/images/meta-share-v3.jpg" name="twitter:image" />
		<meta content="@dfinity" name="twitter:creator" />

		<link crossorigin="anonymous" href="/manifest.webmanifest" rel="manifest" />

		<!-- Favicon -->
		<link
			rel="icon"
			type="image/png"
			sizes="32x32"
			href="%sveltekit.assets%/favicons/favicon-32x32.png"
		/>
		<link
			rel="icon"
			type="image/png"
			sizes="16x16"
			href="%sveltekit.assets%/favicons/favicon-16x16.png"
		/>
		<link rel="shortcut icon" href="%sveltekit.assets%/favicon.ico" />

		<!-- iOS meta tags & icons -->
		<meta name="mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="#016DFC" />
		<meta name="apple-mobile-web-app-title" content="{{OISY_NAME}}" />
		<link rel="apple-touch-icon" href="%sveltekit.assets%/favicons/apple-touch-icon.png" />
		<link
			rel="mask-icon"
			href="%sveltekit.assets%/favicons/safari-pinned-tab.svg"
			color="#016DFC"
		/>

		<!-- MS -->
		<meta name="msapplication-TileColor" content="#016DFC" />
		<meta name="msapplication-config" content="%sveltekit.assets%/favicons/browserconfig.xml" />

		<meta content="#FFFFFF" name="theme-color" />
		%sveltekit.head%
		<!-- ROUTE_STYLE -->

		<style>
			#app-spinner {
					--spinner-size: 30px;

          width: 30px;
          height: 30px;
          border: 3px solid rgb(0, 102, 255);
          border-top-color: transparent;
          border-radius: 50%;
          animation: spin 0.75s ease-in-out 40; /* limit to 40*0.75 to avoid gpu leaks, shouldnt take longer than 30s */
          position: absolute;
          top: 50%;
          left: 50%;
					transform: rotate(0deg);
          margin-left: -15px;
          margin-top: -15px;
          box-sizing: border-box;
      }

      @keyframes spin {
          to { transform: rotate(360deg); }
      }

			#app-background-container {
				contain: paint;
				pointer-events: none;

				position: fixed;
				top: 0;
				left: 50%;

				transform: translateX(-50%);

				width: 100%;
				height: 100%;

				z-index: -1;

				overflow: hidden;
			}

			#app-background-light,
			#app-background-dark {
				contain: paint;
				pointer-events: none;

				width: 100%;
				min-width: 1728px;
			}

			:root[theme='light'] {
				#app-background-light {
					display: block;
				}

				#app-background-dark {
					display: none;
				}
			}

			:root[theme='dark'] {
				#app-background-light {
					display: none;
				}

				#app-background-dark {
					display: block;
				}
			}
		</style>

		<!-- LINKS_PRELOADER -->
	</head>
	<body data-sveltekit-preload-data="hover">
		<div id="app-background-container">
			<img
				id="app-background-light"
				src="/images/oisy_bg_light.webp"
				alt="OISY Background light theme"
			/>
			<img
				id="app-background-dark"
				src="/images/oisy_bg_dark.webp"
				alt="OISY Background dark theme"
			/>
		</div>

		<div style="display: contents">%sveltekit.body%</div>

		<!-- All resources required to boot the dapp can take some times to be downloaded on the IC. -->
		<!-- That's why we are displaying a spinner while the dapp is starting. -->
		<!-- Spinner which is then removed as soon as the authentication is initialized (regardless if sign-in or sign-out) -->
		<div id="app-spinner"
				 aria-hidden="true"
				 data-tid="spinner"
		></div>

		<div id="app-spinner-tst"></div>

		<!-- SCRIPT_LOADER -->
	</body>
</html>
